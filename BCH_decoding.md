# Декодирование кодов БЧХ

[![hackmd-github-sync-badge](https://hackmd.io/W8KIo-z2QX-abC950DT4BA/badge)](https://hackmd.io/W8KIo-z2QX-abC950DT4BA)

[TOC]

## Построение кода Рида-Соломона
:::info
Построим код над полем $GF(13)$.

Вычисления в поле --- по модулю 13.

$\forall x \neq 0, x \in GF(13) : x^{12} = 1$

Обозначим $a$ примитивный элемент поля.
:::

Таблица логарифмов и антилогарифмов:
| Степень примитивного элемента $a$ | Элемент поля |
|:---------------------------------:|:------------:|
|             $-\infty$             |      0       |
|                 0                 |      1       |
|                 1                 |      2       |
|                 2                 |     ???      |
|                 3                 |     ???      |
|                 4                 |     ???      |
|                 5                 |     ???      |
|                 6                 |     ???      |
|                 7                 |     ???      |
|                 8                 |     ???      |
|                 9                 |     ???      |
|                10                 |     ???      |
|                11                 |     ???      |
|                12                 |      1       |

:::info
Пусть минимальное расстояние кода $d = 7$.
:::

Длина кода: ???

Размерность: ???

:::info
Пусть параметр $b = 3$. Построим код БЧХ над $GF(13)$.

Обозначим $a$ --- примитивный элемент поля.
:::

Корни порождающего многочлена: ???

Минимальный многочлен элемента $a \in GF(13)$: $f_a(x) = ???$

:::info
Порождающий многочлен 
:::
$$
g(x) = ???
$$

---
## Кодирование

:::info
Пусть дан информационный многочлен
$u(x) = 7x^5 + 3x^4 + 11x^2 + 12x + 4$.

Тогда кодовый многочлен 
$$
c(x) = u(x)g(x) =\\ 
a^{11} x^{11} + a^7 x^{10} + a^3 x^9 + a^4 x^8 + a^2 x^6 + a^2 x^5 + a^4 x^3 + a^3 x^2 + a^7 x + a^{11}
$$
:::

:::info
Внесем 3 ошибки.
$e(x) = a^5 x^9 + a^4 x^5 + a^2 x^4$
$$
y(x) = c(x) + e(x) =\\
a^{11} x^{11} + a^7 x^{10} + a^0 x^9 + a^4 x^8 + a^2 x^6 + a^{11} x^5 + a^2 x^4 + a^4 x^3 + a^3 x^2 + a^7 x + a^{11}
$$
:::

---
## Вычисление синдрома

:::info
$S_i = y(a^{b+i-1}) = c(a^{b+i-1}) + e(a^{b+i-1}) = e(a^{b+i-1})$
:::

$S_1 = ???$
$S_2 = ???$
$S_3 = ???$
$S_4 = ???$
$S_5 = ???$
$S_6 = ???$

---
## Алгоритм Берлекэмпа-Месси

:::info
Вспомним алгоритм Питерсона-Горенстейна-Цирлера:

Обозначения:
- $h_j$ --- позиция $j$-той ошибки
- $X_j = a^{h_j}$ --- локатор $j$-той ошибки
- $Y_j$ --- значение ошибки
- Синдром:
$S_i = \sum_j Y_jX_j^{b + i - 1}$
- Многочлен локаторов ошибок:
$\Lambda(x) = \prod_j (1 - xX_j) = 1 + \Lambda_1x + \dots + \Lambda_{\nu}x^{\nu}$

Система уравнений, связывающая $S_i$ и $\Lambda_i$:
$$
\begin{pmatrix}
S_1 & S_2 & S_3\\
S_2 & S_3 & S_4\\
S_3 & S_4 & S_5\\
\end{pmatrix} \begin{pmatrix}
\Lambda_3\\
\Lambda_2\\
\Lambda_1\\
\end{pmatrix} = \begin{pmatrix}
-S_4\\
-S_5\\
-S_6\\
\end{pmatrix}
$$
:::

:::success
Матрица системы сильно структурирована!
:::

![Регистр сдвига](https://raw.githubusercontent.com/nyakuba/hackmd/main/resources/BCH_decoding/shift_register.png)

:::info
Задача нахождения коэффициентов многочлена локаторов ошибок сводится к задаче построения регистра сдвига минимальной длины, порождающего компоненты синдрома $S_i$.
:::

:::warning
**Теорема 1**
      
Пусть $\Lambda^{(r-1)}$ --- регистр сдвига минимальной длины $L^{(r-1)}$, порождающий $S_1, S_2, \dots, S_{r-1}$, но не порождающий $S_r$.

Тогда минимальная длина регистра сдвига $\Lambda^{(r)}$, порождающего $S_1, S_2, \dots, S_r$ удовлетворяет
$$
L^{(r)} = \max\{L^{(r-1)}, r - L^{(r-1)}\}
$$
:::

:::danger
**Теорема 2**

Положим $\Lambda^{(0)} = 1$ и $L^{(0)} = 0$. 

Пусть $\Lambda^{(r-1)}(x)$ --- регистр сдвига минимальной длины $L^{(r-1)}$, порождающий значения $S_1, S_2, \dots, S_{r-1}$. 

Обозначим $\Delta_i$ --- невязку
$$
\Delta_i = S_i + \sum_{j=1}^{L^{(i-1)}}\Lambda_j^{(i-1)}S_{i-j},
$$
причем $\Delta_0 = 0$.
Тогда регистр сдвига с многочленом связей
$$
\Lambda^{(r)} = \begin{cases}
  \Lambda^{(r-1)}, & \text{ если } \Delta_r = 0\\
  \Lambda^{(r-1)} - \frac{\Delta_r}{\Delta_m}x^{r-m}\Lambda^{(m-1)}(x), & \text{ если } \Delta_r \neq 0
\end{cases}
$$
порождает $S_1, S_2, \dots, S_r$, где $m < r$ --- наибольшее число такое, что $L^{(m-1)} < L^{(m)}$.
:::

### r = 1
???

### r = 2
???

### r = 3
???

### r = 4
???

### r = 5
???

### r = 6
???

:::info
Многочлен локаторов ошибок
:::
$$
\Lambda(x) = ???
$$

Корни многочлена --- $???$

$$
X_1 = ???, X_2 = ???, X_3 = ???
$$

---
## Ключевое уравнение

:::info
Введем синдромный многочлен, коэффициентами которого являются элементы вектора синдрома $S_i = y(a^{b+i-1})$.
$$
S(x) = \sum_{i=0}^{\delta - 2} S_{i+1}x^i
$$
:::

:::info
Преобразуем выражение полагая число ошибок равным $\nu$.
$$
S(x) = \sum_{i=0}^{\delta-2} \sum_{j=1}^{\nu}Y_jX_j^{b+i}x^i = \sum_{j=1}^{\nu}Y_jX_j^b \sum_{i=0}^{\delta-2} (X_jx)^i\\
(1 - X_jx)\sum_{i=0}^{\delta-2}(X_jx)^i = 1 - (X_jx)^{\delta-1} \equiv 1 \mod x^{\delta-1}\\
S(x) \equiv \sum_{j=1}^{\nu}\frac{Y_jX_j^b}{(1 - X_jx)} \mod x^{\delta-1}
$$
:::

:::info
Введем многочлен значений ошибок:
$$
\Gamma(x) = \sum_{j=1}^{\nu}Y_jX_j^b\prod_{t \neq j}(1 - X_tx) = \Lambda(x)\sum_{j=1}^{\nu}\frac{Y_jX_j^b}{1 - X_jx}
$$
:::

:::danger
**Ключевое уравнение декодирования кода БЧХ**
$$
\Gamma(x) \equiv \Lambda(x)S(x) \mod x^{\delta-1},
$$
причем $\deg\Gamma(x) < \deg\Lambda(x) \leq \lfloor (\delta - 1) / 2 \rfloor$.
:::

### Вычисление значений ошибок
:::info
Значения ошибок могут быть выражены непосредственно из $\Gamma(x)$:
$$
Y_j = \frac{X_j^{-b}\Gamma(X_j^{-1})}{\prod_{t\neq j}(1 - X_tX_j^{-1})} = -X_j^{-b} \frac{\Gamma(X_j^{-1})}{\Lambda'(X_j^{-1})},
$$
где $\Lambda'(x)$ --- формальная производная многочлена $\Lambda(x)$ по переменной $x$.
:::

$$
\Gamma(x) = ???\\
\Lambda'(x) = ???
$$

$$
Y_1 = ???, Y_2 = ???, Y_3 = ???
$$

## Алгоритм Сугиямы (расширенный алгоритм Евклида)
:::info
Вспомним ключевое уравнение
$$
\Gamma(x) \equiv \Lambda(x)S(x) \mod x^{\delta-1},
$$
причем $\deg\Gamma(x) < \deg\Lambda(x) \leq \lfloor (\delta - 1) / 2 \rfloor$.

Иначе говоря,
$$
Q(x)x^{\delta-1} + \Lambda(x)S(x) = \Gamma(x)
$$
$\Gamma(x)$ --- НОД, $Q(x), \Lambda(x)$ --- коэффициенты теоремы Безу.
:::

Вычисления: ???